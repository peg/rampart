# Rampart Policy — OpenClaw Example
# Tuned for securing an OpenClaw agent.
# Customize to your needs, then: rampart serve --config openclaw.yaml

version: "1"
default_action: allow

policies:
  # ── Credential Protection ──────────────────────────────────────
  - name: protect-credentials
    priority: 1
    match:
      tool: ["read"]
    rules:
      - action: deny
        when:
          path_matches:
            - "**/.ssh/id_*"
            - "**/.aws/credentials"
            - "**/.gnupg/*"
            - "**/*.pem"
            - "**/*.key"
            - "**/.env"
            - "**/.env.*"
            - "**/.netrc"
            - "**/.git-credentials"
        message: "Credential file access blocked"

  # ── Identity Protection ────────────────────────────────────────
  - name: protect-identity
    match:
      tool: ["write"]
    rules:
      - action: deny
        when:
          path_matches:
            - "**/SOUL.md"
            - "**/AGENTS.md"
            - "**/.openclaw/*"
        message: "Agent cannot modify its own identity files"

  # ── Command Execution Safety ───────────────────────────────────
  - name: exec-safety
    match:
      tool: "exec"
    rules:
      - action: deny
        when:
          command_matches:
            - "rm -rf /"
            - "rm -rf ~"
            - "rm -rf /*"
            - "rm -rf ~/*"
            - ":(){ :|:& };:"
            - "mkfs.*"
            - "dd if=/dev/zero*"
            - "chmod -R 777 /"
            - "curl * | sh"
            - "curl * | bash"
            - "wget * | sh"
            - "wget * | bash"
        message: "Destructive command pattern blocked"

  - name: log-privileged
    match:
      tool: "exec"
    rules:
      - action: log
        when:
          command_matches:
            - "sudo *"
            - "systemctl *"
            - "docker rm *"
            - "docker stop *"
            - "kubectl delete *"
            - "kubectl apply *"
        message: "Privileged command logged for review"

  - name: log-network
    match:
      tool: "exec"
    rules:
      - action: log
        when:
          command_matches:
            - "curl *"
            - "wget *"
            - "scp *"
            - "rsync *"
        message: "Network command logged"
